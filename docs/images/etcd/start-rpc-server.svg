<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1646px" preserveAspectRatio="none" style="width:2067px;height:1646px;background:#FFFFFF;" version="1.1" viewBox="0 0 2067 1646" width="2067px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="169" x="945.25" y="28.5352">etcd server start(v3.4.3)</text><rect fill="#FFFFFF" height="1472.9063" style="stroke:#181818;stroke-width:1.0;" width="10" x="35" y="113.2871"/><rect fill="#FFFFFF" height="1418.5957" style="stroke:#181818;stroke-width:1.0;" width="10" x="177" y="147.5977"/><rect fill="#FFFFFF" height="1375.2852" style="stroke:#181818;stroke-width:1.0;" width="10" x="349" y="176.9082"/><rect fill="#FFFFFF" height="1316.9746" style="stroke:#181818;stroke-width:1.0;" width="10" x="354" y="214.2188"/><rect fill="#FFFFFF" height="1262.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="248.5293"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="594.7031"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="667.0137"/><rect fill="#FFFFFF" height="750.8691" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="739.3242"/><rect fill="#FFFFFF" height="681.5586" style="stroke:#181818;stroke-width:1.0;" width="10" x="516" y="781.6348"/><rect fill="#FFFFFF" height="276.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="729" y="280.8398"/><rect fill="#FFFFFF" height="230.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="911" y="313.1504"/><rect fill="#FFFFFF" height="171.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="916" y="350.4609"/><rect fill="#FFFFFF" height="25" style="stroke:#181818;stroke-width:1.0;" width="10" x="921" y="392.7715"/><rect fill="#FFFFFF" height="29.1553" style="stroke:#181818;stroke-width:1.0;" width="10" x="921" y="466.2373"/><rect fill="#FFFFFF" height="624.248" style="stroke:#181818;stroke-width:1.0;" width="10" x="1089" y="818.9453"/><rect fill="#FFFFFF" height="472.04" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274" y="892.5322"/><rect fill="#FFFFFF" height="200.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1506.5" y="1134.5352"/><rect fill="#FFFFFF" height="24.6553" style="stroke:#181818;stroke-width:1.0;" width="10" x="1688" y="1393.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="40" x2="40" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182" x2="182" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="353.5" x2="353.5" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="510.5" x2="510.5" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="734" x2="734" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="916" x2="916" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094" x2="1094" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1279" x2="1279" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1511" x2="1511" y1="73.9766" y2="1611.1934"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1693" x2="1693" y1="73.9766" y2="1611.1934"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="12" y="63.0234">main.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="5" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="12" y="1630.7285">main.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="112" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="119" y="63.0234">etcdmain/main.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="112" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="119" y="1630.7285">etcdmain/main.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="286.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="293.5" y="63.0234">etcdmain/etcd.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="286.5" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="293.5" y="1630.7285">etcdmain/etcd.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="451.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="458.5" y="63.0234">embed/etcd.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="451.5" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="458.5" y="1630.7285">embed/etcd.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="656" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="663" y="63.0234">etcdserver/server.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="656" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="663" y="1630.7285">etcdserver/server.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="822" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="829" y="63.0234">mvcc/watchable_store.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="822" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="829" y="1630.7285">mvcc/watchable_store.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132" x="1028" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="1035" y="63.0234">embed/server.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132" x="1028" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="1035" y="1630.7285">embed/server.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="218" x="1170" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="1177" y="63.0234">etcdserver/api/v3rpc/grpc.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="218" x="1170" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="1177" y="1630.7285">etcdserver/api/v3rpc/grpc.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="1398" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213" x="1405" y="63.0234">etcdserver/api/v3rpc/watch.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="1398" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213" x="1405" y="1630.7285">etcdserver/api/v3rpc/watch.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1635" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1642" y="63.0234">grpc/server.go</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1635" y="1610.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1642" y="1630.7285">grpc/server.go</text><rect fill="#FFFFFF" height="1472.9063" style="stroke:#181818;stroke-width:1.0;" width="10" x="35" y="113.2871"/><rect fill="#FFFFFF" height="1418.5957" style="stroke:#181818;stroke-width:1.0;" width="10" x="177" y="147.5977"/><rect fill="#FFFFFF" height="1375.2852" style="stroke:#181818;stroke-width:1.0;" width="10" x="349" y="176.9082"/><rect fill="#FFFFFF" height="1316.9746" style="stroke:#181818;stroke-width:1.0;" width="10" x="354" y="214.2188"/><rect fill="#FFFFFF" height="1262.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="248.5293"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="594.7031"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="667.0137"/><rect fill="#FFFFFF" height="750.8691" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="739.3242"/><rect fill="#FFFFFF" height="681.5586" style="stroke:#181818;stroke-width:1.0;" width="10" x="516" y="781.6348"/><rect fill="#FFFFFF" height="276.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="729" y="280.8398"/><rect fill="#FFFFFF" height="230.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="911" y="313.1504"/><rect fill="#FFFFFF" height="171.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="916" y="350.4609"/><rect fill="#FFFFFF" height="25" style="stroke:#181818;stroke-width:1.0;" width="10" x="921" y="392.7715"/><rect fill="#FFFFFF" height="29.1553" style="stroke:#181818;stroke-width:1.0;" width="10" x="921" y="466.2373"/><rect fill="#FFFFFF" height="624.248" style="stroke:#181818;stroke-width:1.0;" width="10" x="1089" y="818.9453"/><rect fill="#FFFFFF" height="472.04" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274" y="892.5322"/><rect fill="#FFFFFF" height="200.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1506.5" y="1134.5352"/><rect fill="#FFFFFF" height="24.6553" style="stroke:#181818;stroke-width:1.0;" width="10" x="1688" y="1393.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="40" x2="87" y1="100.2871" y2="100.2871"/><line style="stroke:#181818;stroke-width:1.0;" x1="87" x2="87" y1="100.2871" y2="113.2871"/><line style="stroke:#181818;stroke-width:1.0;" x1="46" x2="87" y1="113.2871" y2="113.2871"/><polygon fill="#181818" points="56,109.2871,46,113.2871,56,117.2871,52,113.2871" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="52" y="95.5449">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="65" y="95.5449">main()</text><polygon fill="#181818" points="165,143.5977,175,147.5977,165,151.5977,169,147.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45" x2="171" y1="147.5977" y2="147.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="52" y="142.8555">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="65" y="142.8555">etcdmain.Main()</text><polygon fill="#181818" points="337,172.9082,347,176.9082,337,180.9082,341,176.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187" x2="343" y1="176.9082" y2="176.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="194" y="172.166">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="207" y="172.166">startEtcdOrProxyV2()</text><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="406" y1="201.2188" y2="201.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="406" x2="406" y1="201.2188" y2="214.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="365" x2="406" y1="214.2188" y2="214.2188"/><polygon fill="#181818" points="375,210.2188,365,214.2188,375,218.2188,371,214.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="371" y="196.4766">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="384" y="196.4766">startEtcd()</text><polygon fill="#181818" points="494,244.5293,504,248.5293,494,252.5293,498,248.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="364" x2="500" y1="248.5293" y2="248.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="371" y="243.7871">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="384" y="243.7871">embed.StartEtcd()</text><polygon fill="#181818" points="717,276.8398,727,280.8398,717,284.8398,721,280.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516" x2="723" y1="280.8398" y2="280.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="523" y="276.0977">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="536" y="276.0977">etcdserver.NewServer(srvcfg)</text><path d="M744,261.5293 L744,286.5293 L912,286.5293 L912,271.5293 L902,261.5293 L744,261.5293 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M902,261.5293 L902,271.5293 L912,271.5293 L902,261.5293 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="750" y="279.0977">create a new EtcdServer</text><polygon fill="#181818" points="899,309.1504,909,313.1504,899,317.1504,903,313.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="739" x2="905" y1="313.1504" y2="313.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="746" y="308.4082">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="759" y="308.4082">mvcc.New()</text><line style="stroke:#181818;stroke-width:1.0;" x1="921" x2="968" y1="337.4609" y2="337.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="968" x2="968" y1="337.4609" y2="350.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="927" x2="968" y1="350.4609" y2="350.4609"/><polygon fill="#181818" points="937,346.4609,927,350.4609,937,354.4609,933,350.4609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="933" y="332.7188">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="946" y="332.7188">newWatchableStore()</text><line style="stroke:#181818;stroke-width:1.0;" x1="926" x2="973" y1="379.7715" y2="379.7715"/><line style="stroke:#181818;stroke-width:1.0;" x1="973" x2="973" y1="379.7715" y2="392.7715"/><line style="stroke:#181818;stroke-width:1.0;" x1="932" x2="973" y1="392.7715" y2="392.7715"/><polygon fill="#181818" points="942,388.7715,932,392.7715,942,396.7715,938,392.7715" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="938" y="375.0293">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="951" y="375.0293">s.syncWatchersLoop()</text><path d="M1099,371.9609 L1099,396.9609 L1522,396.9609 L1522,381.9609 L1512,371.9609 L1099,371.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1512,371.9609 L1512,381.9609 L1522,381.9609 L1512,371.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="1105" y="389.5293">syncs the watcher in the unsynced map every 100ms(hard code)</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="931" x2="973" y1="416.7715" y2="416.7715"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="973" x2="973" y1="416.7715" y2="429.7715"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="926" x2="973" y1="429.7715" y2="429.7715"/><polygon fill="#181818" points="936,425.7715,926,429.7715,936,433.7715,932,429.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="926" x2="973" y1="453.2373" y2="453.2373"/><line style="stroke:#181818;stroke-width:1.0;" x1="973" x2="973" y1="453.2373" y2="466.2373"/><line style="stroke:#181818;stroke-width:1.0;" x1="932" x2="973" y1="466.2373" y2="466.2373"/><polygon fill="#181818" points="942,462.2373,932,466.2373,942,470.2373,938,466.2373" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="938" y="448.4951">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="960" y="448.4951">s.syncVictimsLoop()</text><path d="M1098,437.7715 L1098,477.7715 L1535,477.7715 L1535,447.7715 L1525,437.7715 L1098,437.7715 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1525,437.7715 L1525,447.7715 L1535,447.7715 L1525,437.7715 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416" x="1104" y="455.3398">syncVictimsLoop tries to write precomputed watcher responses to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392" x="1104" y="470.6504">watchers that had a blocked watcher channel(10ms hard code)</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="931" x2="973" y1="494.3926" y2="494.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="973" x2="973" y1="494.3926" y2="507.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="926" x2="973" y1="507.3926" y2="507.3926"/><polygon fill="#181818" points="936,503.3926,926,507.3926,936,511.3926,932,507.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="926" x2="968" y1="521.3926" y2="521.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="968" x2="968" y1="521.3926" y2="534.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="921" x2="968" y1="534.3926" y2="534.3926"/><polygon fill="#181818" points="931,530.3926,921,534.3926,931,538.3926,927,534.3926" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="750,539.3926,740,543.3926,750,547.3926,746,543.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="744" x2="915" y1="543.3926" y2="543.3926"/><polygon fill="#181818" points="527,553.3926,517,557.3926,527,561.3926,523,557.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521" x2="733" y1="557.3926" y2="557.3926"/><line style="stroke:#181818;stroke-width:1.0;" x1="521" x2="563" y1="586.7031" y2="586.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="563" x2="563" y1="586.7031" y2="599.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="563" y1="599.7031" y2="599.7031"/><polygon fill="#181818" points="532,595.7031,522,599.7031,532,603.7031,528,599.7031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="528" y="581.9609">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="550" y="581.9609">e.Server.Start()</text><line style="stroke:#181818;stroke-width:1.0;" x1="521" x2="563" y1="659.0137" y2="659.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="563" x2="563" y1="659.0137" y2="672.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="563" y1="672.0137" y2="672.0137"/><polygon fill="#181818" points="532,668.0137,522,672.0137,532,676.0137,528,672.0137" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="528" y="654.2715">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="550" y="654.2715">e.servePeers()</text><line style="stroke:#181818;stroke-width:1.0;" x1="516" x2="563" y1="726.3242" y2="726.3242"/><line style="stroke:#181818;stroke-width:1.0;" x1="563" x2="563" y1="726.3242" y2="739.3242"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="563" y1="739.3242" y2="739.3242"/><polygon fill="#181818" points="532,735.3242,522,739.3242,532,743.3242,528,739.3242" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="528" y="721.582">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="550" y="721.582">e.serveClients()</text><line style="stroke:#181818;stroke-width:1.0;" x1="521" x2="568" y1="768.6348" y2="768.6348"/><line style="stroke:#181818;stroke-width:1.0;" x1="568" x2="568" y1="768.6348" y2="781.6348"/><line style="stroke:#181818;stroke-width:1.0;" x1="527" x2="568" y1="781.6348" y2="781.6348"/><polygon fill="#181818" points="537,777.6348,527,781.6348,537,785.6348,533,781.6348" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="533" y="763.8926">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="555" y="763.8926">e.errHandler()</text><polygon fill="#181818" points="1077,814.9453,1087,818.9453,1077,822.9453,1081,818.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="526" x2="1083" y1="818.9453" y2="818.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="533" y="814.2031">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="555" y="814.2031">s.serve()</text><path d="M1104,799.6348 L1104,824.6348 L1489,824.6348 L1489,809.6348 L1479,799.6348 L1104,799.6348 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1479,799.6348 L1479,809.6348 L1489,809.6348 L1479,799.6348 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364" x="1110" y="817.2031">accepts incoming connections(also start the grpc servers)</text><polygon fill="#181818" points="1262,888.5322,1272,892.5322,1262,896.5322,1266,892.5322" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1099" x2="1268" y1="892.5322" y2="892.5322"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1106" y="887.79">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="1128" y="887.79">gs = v3rpc.Server()</text><path d="M1289,834.9453 L1289,935.9453 L1739,935.9453 L1739,844.9453 L1729,834.9453 L1289,834.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1729,834.9453 L1729,844.9453 L1739,844.9453 L1729,834.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="1295" y="852.5137">pb.RegisterKVServer(grpcServer, NewQuotaKVServer(s))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347" x="1295" y="867.8242">pb.RegisterWatchServer(grpcServer, NewWatchServer(s))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379" x="1295" y="883.1348">pb.RegisterLeaseServer(grpcServer, NewQuotaLeaseServer(s))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361" x="1295" y="898.4453">pb.RegisterClusterServer(grpcServer, NewClusterServer(s))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="1295" y="913.7559">pb.RegisterAuthServer(grpcServer, NewAuthServer(s))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429" x="1295" y="929.0664">pb.RegisterMaintenanceServer(grpcServer, NewMaintenanceServer(s))</text><polygon fill="#181818" points="1494.5,1130.5352,1504.5,1134.5352,1494.5,1138.5352,1498.5,1134.5352" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1284" x2="1500.5" y1="1134.5352" y2="1134.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1291" y="1129.793">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="1313" y="1129.793">NewWatchServer(s)</text><path d="M1521,946.8086 L1521,1308.8086 L2060,1308.8086 L2060,956.8086 L2050,946.8086 L1521,946.8086 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2050,946.8086 L2050,956.8086 L2060,956.8086 L2050,946.8086 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="451" x="1527" y="964.377">func (ws *watchServer) Watch(stream pb.Watch_WatchServer) (err error) {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1543" y="979.6875">sws := serverWatchStream{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1559" y="994.998">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="1591" y="1010.3086">watchable: ws.watchable,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1527" y="1025.6191">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="1591" y="1040.9297">gRPCStream:  stream,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="1591" y="1056.2402">watchStream: ws.watchable.NewWatchStream(),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454" x="1591" y="1071.5508">// chan for sending control response like watcher created and canceled.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="1591" y="1086.8613">ctrlStream: make(chan *pb.WatchResponse, ctrlStreamBufLen),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1591" y="1102.1719">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1559" y="1117.4824">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1559" y="1132.793">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="1559" y="1148.1035">go func() {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1591" y="1163.4141">sws.sendLoop()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1591" y="1178.7246">sws.wg.Done()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1559" y="1194.0352">}()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1527" y="1209.3457">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1527" y="1224.6563">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="1559" y="1239.9668">go func() {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="1591" y="1255.2773">if rerr := sws.recvLoop(); rerr != nil {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1591" y="1270.5879">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1559" y="1285.8984">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1527" y="1301.209">}</text><polygon fill="#181818" points="1295,1331.2617,1285,1335.2617,1295,1339.2617,1291,1335.2617" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1289" x2="1510.5" y1="1335.2617" y2="1335.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="1301" y="1330.5195">watchServer</text><polygon fill="#181818" points="1110,1360.5723,1100,1364.5723,1110,1368.5723,1106,1364.5723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1104" x2="1278" y1="1364.5723" y2="1364.5723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="1116" y="1359.8301">grpcServer</text><polygon fill="#181818" points="1676,1389.8828,1686,1393.8828,1676,1397.8828,1680,1393.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1099" x2="1682" y1="1393.8828" y2="1393.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1106" y="1389.1406">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1128" y="1389.1406">errHandler(gs.Serve(grpcl))</text><polygon fill="#181818" points="1110,1414.5381,1100,1418.5381,1110,1422.5381,1106,1418.5381" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1104" x2="1692" y1="1418.5381" y2="1418.5381"/><path d="M1703,1406.8828 L1703,1431.8828 L1989,1431.8828 L1989,1416.8828 L1979,1406.8828 L1703,1406.8828 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1979,1406.8828 L1979,1416.8828 L1989,1416.8828 L1979,1406.8828 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="1709" y="1424.4512">vendor/google.golang.org/grpc/server.go</text><polygon fill="#181818" points="537,1439.1934,527,1443.1934,537,1447.1934,533,1443.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="531" x2="1093" y1="1443.1934" y2="1443.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="526" x2="568" y1="1462.1934" y2="1462.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="568" x2="568" y1="1462.1934" y2="1475.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521" x2="568" y1="1475.1934" y2="1475.1934"/><polygon fill="#181818" points="531,1471.1934,521,1475.1934,531,1479.1934,527,1475.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521" x2="563" y1="1489.1934" y2="1489.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="563" x2="563" y1="1489.1934" y2="1502.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="516" x2="563" y1="1502.1934" y2="1502.1934"/><polygon fill="#181818" points="526,1498.1934,516,1502.1934,526,1506.1934,522,1502.1934" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="375,1507.1934,365,1511.1934,375,1515.1934,371,1511.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="369" x2="510" y1="1511.1934" y2="1511.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="364" x2="406" y1="1530.1934" y2="1530.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="406" x2="406" y1="1530.1934" y2="1543.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="359" x2="406" y1="1543.1934" y2="1543.1934"/><polygon fill="#181818" points="369,1539.1934,359,1543.1934,369,1547.1934,365,1543.1934" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="198,1548.1934,188,1552.1934,198,1556.1934,194,1552.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="353" y1="1552.1934" y2="1552.1934"/><polygon fill="#181818" points="56,1562.1934,46,1566.1934,56,1570.1934,52,1566.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="181" y1="1566.1934" y2="1566.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="45" x2="87" y1="1585.1934" y2="1585.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87" x2="87" y1="1585.1934" y2="1598.1934"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="87" y1="1598.1934" y2="1598.1934"/><polygon fill="#181818" points="50,1594.1934,40,1598.1934,50,1602.1934,46,1598.1934" style="stroke:#181818;stroke-width:1.0;"/><!--SRC=[nLXHRzis47wEVWNNbyf5BBNBdhnbm9OD6B1qpH8WVInecPQ5IAH6KlQ28V-zHrAcIOgIxRNO0YIHTVTzTpmUxyvylP6o5OiyRsjCPTVKMS6QN92_Ea8BCbzLkEIuIH9PoPei49752Wd2juGZ8J6NwVOg-owxcYMuaunspPBm97cD6bpHT8QMfAneyafzoahs2ir_HFR3ebTAS26hBPRa858CxySPb1FgHNwWsh_AteUS0sL5hbt_5IGV-1rdVpy_VdimDG3uDjM3iHaZYHdU8pp34NjxlQFsZfiXi0-hxE5aOqhTiJI0k_OyNMqCdarAP7-GtOD-IWNV5kloODT3sHKQMDwZxKwEiGNB7g0Joa36gt8Z5wZWH6bYHCaEgMKOBfsTsw9Gx7vS1dGcNK4tts5PRF2o9f-4P9pqwMjPt1GUKLTcmP6FUyc34ZZvFG8xuaA4yKHVH2QUQQ71X8jRnjelTYP6wUs84WiaDmJjZ1AggFxOKIKYAwW8BI8G_MVqxktRHgGRp5UeO2joqh96LaNeogbES8nOExN6gKKcAt9EU1yhK6xyw3gUS2AwXdnXl3qRJhYJG8WahmX4dw4Thq2fvGGgVTj92Fj-Ey2Xbb6XrPB-fTemBD46h-0eBMjMF3a0S8fIKgVlOBEGiraGSgHSEMVN_63zzvisSa3_5qUS0gNiZvId7-Rphs5iidv7bnzKS-r7l22xJiGrb0EPCMewpjH9YRMHi7S5PEEjAs9OhTPpEMXs6gETloDmDDB9_ZPmp0LEk-MPEEQK1TpK5Q7oNtbbeTETFYES_uRfgeOCES-A2voq8On39z2xKuD5UGq75mLffO0s0wMkeYLK9oXNO1oAN8fhmSnCfNjGoTkYdsp5q4C_OKk1hj7s2X1z0eNU1ZE4a_cuhNADp9L1uto4BZxf3C5kmM-NsJqu8IJXlp_sH4hFF5uYEDn_TanYAnIpcGlIfI-ESqK1wfPWGIQikV80UbDtwbySx0i3v4-T7F7KaGGOzSr04efXq8X3XmgAmROosFT192BZut2FnbD0LsIJ0mDgTsVN7IrGkXFepUwWCqCQa0e9Wsw3OANwywUFhaeAvmx1BuFdVn84Fm9e5jTzfXjTJM2awYVBikJYmdQB1Tg9p7wwJ41Mtj_T6DG22FN3vHwoV- -2ChiwBKndIZlFzVY0rWpQ2aIvFv-IizeE8gYkdWxJefdeOGw1BIdKDjNmBGMO2idhlTa6Fv5KyxxPH-I-9xj41yMVk_KjeTeFlToNnFml6LB1JbMqBYuWLfbohH-kp8jTcVt2g2er5o_m9mb1rHhSXwYh88CwZ5bRW__UlF_c6j6grggzwPVOl3ITCD5aZFVgoTGCMtSqDvsa6sleCHV7AkN4I14EDySAfpt0n_so5TEuPTmvFci4bLon-5zN3ttDaYgbUkRMy03cUt16F48UjzbjWOVnl6IihDLmLsDQPeoNkG_o8XNo-GtOZ9wnMI_iYSFn920D9eSOytmuE9muYntcdg_16xiz6JrP_bsA4vmJJOd0IEo29deTD4Zuu0vex9BBDsAlkEnfEyk8lQNJh2DazjujIkRUoZKnihbxP-X_gR7Gpm00]--></g></svg>